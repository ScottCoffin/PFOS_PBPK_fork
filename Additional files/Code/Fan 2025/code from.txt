code from https://doi.org/10.1016/j.envint.2025.109591